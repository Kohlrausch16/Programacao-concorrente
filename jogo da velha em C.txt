#include <stdio.h>
#include<stdlib.h>

/*
O tabuleiro é uma matriz de 3x3
O jogo deve permitir jogar com o computador ou com outra pessoa
A cada jogada deve-se mostrar o tabuleiro e verificar se há um vencedor procurando em todas as linhas e colunas da matriz se existem três da mesma letra. 
Lembre-se também se verificar nas diagonais.
Ao final do jogo deve aparecer quem venceu.

Ao entrar no jogo o jogador deve ser questionado se deve jogar contra o pc ou contra um oponente.
Cada jogador deverá escolher uma letra X ou O para jogar,
Sortear um jogador para iniciar jogando
Cada jogador seleciona em qual local quer jogar.

*/

typedef struct {
    char name[20];
    char icon;
} Player;

typedef struct {
    char icon;
    int selected;
} Position;

int gameMenu(){
    printf("JOGO DA VELHA\n");
    printf("\nSelecione o numero de jogadores:\n");
    printf("1 Jogador\n");
    printf("2 Jogadores\n");
    int option;
    do{
        printf("Opcao: ");
        scanf("%d", &option);
    } while (option != 1 && option != 2);

    return option;
}

void generatePositions(Position gameField[3][3]) {
    int w = 0;
    char icons[] = {'1', '2', '3', '4', '5', '6', '7', '8', '9'};

    for (int i = 0; i < 3; i++) {
        for (int j = 0; j < 3; j++) {
            gameField[i][j].icon = icons[w];
            gameField[i][j].selected = 0;
            w++;
        }
    }
}

void printGameLayout(Position gameField[3][3]){
    for (int i = 0; i < 3; i++) {
        for (int j = 0; j < 3; j++) {
            printf("%c  ", gameField[i][j].icon);
        }
        printf("\n");
    }    
}

Player generatePlayer(int option){
  setbuf(stdin, NULL);
  Player player;
  printf("\nNome: ");
  fgets(player.name, sizeof(player.name), stdin);
  setbuf(stdin, NULL);
  printf("Icon: ");
  scanf("%c", &player.icon);
  setbuf(stdin, NULL);
  return player;
}

int main() {
   
  int winner = 0;
  int *selectedPositions;

  Position gameField[3][3];

  // Chamar menu
  // Cadastrar jogadores

  int option = gameMenu(gameField);

  if(option == 1){
    Player player = generatePlayer(option);
    printf("\nJogador criado!\n");
    printf("\nNome: %s", player.name);
    printf("Icone: %c\n", player.icon);
  } else {
    Player playerOne = generatePlayer(option);
    Player playerTwo = generatePlayer(option);

    printf("\nJogador criado!\n");
    printf("\nNome: %s", playerOne.name);
    printf("Icone: %c\n", playerOne.icon);
    
    printf("\nJogador criado!\n");
    printf("\nNome: %s", playerTwo.name);
    printf("Icone: %c\n", playerTwo.icon);


  }


  generatePositions(gameField);   

  do{
      printGameLayout(gameField);
      winner++;
  } while(winner == 0);

  return 0;
}